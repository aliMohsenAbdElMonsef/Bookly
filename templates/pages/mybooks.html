{%load static%}
<!DOCTYPE html>
<html lang="en" style="height: 100%; width: 113%">
  <head>
    <title>My books</title>
    <link
      rel="stylesheet"
      href="{% static 'css\books.css' %}"
      media="(min-width:1000px)"
    />
    <style>
      body {
        width: 100%;
        height: 100%;
        background: linear-gradient(
            to top,
            rgba(0, 0, 0, 0.3) 30%,
            rgba(0, 0, 0, 0.3) 40%
          ),
          url("{% static 'images/backGroundImage.jpg' %}");
        background-color: rgba(151, 155, 125, 0.82);
        background-position: center;
        background-size: cover;
      }
      .book-container {
        position: absolute;
        margin-top: 89px;
      }
      .navbar {
        width: 2000px;
        height: 24px;
        margin-top: -1px;
        padding-bottom: 50px;
        z-index: 1000;
        position: fixed;
        background-color: #000000;
      }
    </style>
  </head>
  <body>
    <div class="main">
      <div class="navbar">
        <div class="icon">
          <h2 class="logo">Bookly</h2>
        </div>
        <div class="menu">
          <ul>
            <li>
              <a href="{% url 'homepage' %}" id="home" class="home">HOME</a>
            </li>
            <li>
              <a href="{% url 'books' %}" id="Books" class="Books">BOOKS</a>
            </li>
            <li>
              <a href="{% url 'mybooks' %}" id="MyBooks" class="my-books"
                >MY BOOKS</a
              >
            </li>
            {% if user.is_authenticated %} {% if user.is_staff %}
            <li>
              <a href="{% url 'addbook' %}" id="AddBooks" class="add-book">
                ADD BOOK
              </a>
            </li>
            {% endif %} {% endif %} {% if not user.is_authenticated %}
            <li>
              <a href="{% url 'login' %}" id="logIn" class="log-in"> LOG IN </a>
            </li>
            <li>
              <a href="{% url 'signup' %}" id="signUp" class="sign-up">
                sign up
              </a>
            </li>
            {% endif %}

            <li>
              <a href="{% url 'aboutus' %}" id="AboutUs" class="aboutus">
                About Us
              </a>
            </li>
            {% if user.is_authenticated %}
            <li>
              <button id="LogOut" class="log-out" onclick="logoutfun()">
                LOG OUT
              </button>
            </li>
            {% endif %}
          </ul>
        </div>
        <div class="search">
          <input
            class="srch"
            type="search"
            name=""
            placeholder="Type book name,author,Category "
          />
          <a href="#"> <button class="btn">Search</button></a>
        </div>
      </div>
      <div class="book-container">
        {% if not books %}
        <h1 id="nobooks" style="margin-top: 51px; grid-column: span 2">
          There are no books in my books page!!
        </h1>
        {% endif %} {% for i in books %}
        <div
          class="book {{i.category}}"
          booktitle="{{i.title}}"
          bookcategory="{{i.category}}"
          bookauthor="{{i.author}}"
          id="{{i.title}}"
        >
          <div class="book-inner">
            <div class="book-front">
              <img src="{{i.image.url}}" alt="Book 1" />
            </div>
            <div class="book-back">
              <p class="author">{{i.author}}</p>
              <p class="description">{{i.description}}</p>
              <p class="category" style="display: none">{{i.category}}</p>
              <div class="button-container" username="{{user.username}}">
                <button
                  id="button2"
                  class="cancel-button"
                  booktitle="{{i.title}}"
                  username="{{user.username}}"
                  userid="{{user.id}}"
                >
                  unBorrow
                </button>
                {%if user.is_staff%}
                <button
                  id="button3"
                  class="delete-button"
                  booktitle="{{i.title}}"
                >
                  Delete
                </button>
                <button
                  id="button2"
                  class="edit-button"
                  bookid="{{i.id}}"
                  booktitle="{{i.title}}"
                  bookauthor="{{i.author}}"
                  bookcategory="{{i.category}}"
                >
                  Edit
                </button>
                {%endif%}
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    <script src="{% static 'js/all.js' %}">
      //         let data = window.localStorage;
      //         // data.clear();
      //         let add=document.getElementsByClassName("add-book")[0];
      //         let role=null;
      //         let users=JSON.parse(data.getItem("users"))
      //         for(let i=0;i<users.length;i++){
      //             if(users[i].userName==JSON.parse(data.getItem("name"))){
      //                 role=users[i];
      //                 break;
      //             }
      //         }
      //         console.log(role)
      //         role2=role.class;
      //         let btn=document.querySelector(".log-out");

      //         if (JSON.parse(data.getItem("name")) === null) {
      //     let parent = document.getElementsByClassName("menu")[0];
      //     let link = parent.querySelectorAll("a");
      //     link.forEach(item => {
      //         if (!(item.id === "logIn" || item.id === "signUp")) {
      //             item.style.display = "none";
      //         }
      //     });
      //     parent.querySelector("button").style.display = "none";
      // }
      // else {
      //     document.getElementById("signUp").style.display = "none";
      // }
      // if(role2==="user"){
      //             add.style.display="none";

      //         }
      //             btn.onclick = function () {
      //             let parent = document.getElementsByClassName("menu")[0];
      //             let links = parent.querySelectorAll("a");
      //             links.forEach(item => {
      //                 if (!(item.id === "logIn" || item.id === "signUp")) {
      //                     item.style.display = "none";
      //                 }

      //             parent.querySelector("button").style.display = "none";
      //         } );

      //                 let users = JSON.parse(data.getItem("users"));
      //                 let logged=JSON.parse(data.getItem("name"));
      //                 logged=null;
      //                 data.setItem("name",logged);
      //             for (let i = 0; i < users.length; i++) {
      //             if (users[i].userName === JSON.parse(data.getItem("name"))) {
      //                 users[i].loged=false;
      //                 break;
      //             }
      //             }
      //             data.setItem("users",JSON.stringify(users));
      //                 console.log(data);
      //                 document.getElementsByClassName("log-in")[0].style.display = "none";
      //                 location.reload();
      //                 window.location.href = "./login.html";
      //             };
      //         if(role.books.length!=0)
      //         document.querySelector(".content").innerHTML="";
      //         if(role.loged===true){
      //             document.getElementsByClassName("log-in")[0].style.display="none";
      //         }
      //         else{
      //             document.getElementsByClassName("log-out")[0].style.display="none";
      //         }
      //         if(role.loged===true)
      //         {
      //             let inbook=role.books;
      //             let contaner = document.createElement("div");
      //             document.querySelector(".main").appendChild(contaner);
      //             contaner.className = "book-container";
      //             contaner.className = "book-container";
      //             document.querySelector(".main").appendChild(contaner);
      //             for(let i = 0; i< inbook.length ; i++){
      //                 let var1={};
      //                 // if(inbook[i]===var2)continue;
      //                 let tmp = `
      //                 <div class="book ${inbook[i].category}" id="${inbook[i].name}">
      //                     <div class="book-inner">
      //                         <div class="book-front">
      //                             <img src= ${inbook[i].img}  alt="Book 1">
      //                             </div>
      //                             <div class="book-back">
      //                                 <p class="author">${inbook[i].author}</p>
      //                                 <p class="description">
      //                                     ${inbook[i].des}
      //                                     </p>
      //                                     <p class=category style="display:none">${inbook[i].category}</p>
      //                                     <div class="button-container">
      //                                         <button id="button2" class="cancel-button" >unBorrow</button>

      //                                         <a href="Edit.html"class="Edit"> <button id="button2">Edit</button></a>
      //                                         </div>
      //                                         </div>
      //                                         </div>
      //                                         </div>
      //                                         `;
      //                                         contaner.insertAdjacentHTML("beforeend", tmp);
      //                                     }
      //                                     let buttons = document.querySelectorAll(".book");

      //                                     if (!role.loged) {
      //                                         buttons.forEach(book => {
      //                                             book.querySelector(".button-container").style.display = "none";
      //                                         });
      //                                     }
      //                                     else {
      //                                         if(role.class==="user"){
      //                                             buttons.forEach(book=>{
      //                                                 book.querySelector(".Edit").style.display="none"
      //                                             })
      //                                         }

      // }
      //     let Cbuttons=document.querySelectorAll(".cancel-button");
      //     Cbuttons.forEach(button=>{
      //         button.onclick=function(){
      //             let boBook=button.parentElement.parentElement.parentElement.parentElement;
      //             let arrbooks=JSON.parse(data.getItem("all"));

      //             arrbooks.forEach(bo=>{
      //                 if(boBook.id===bo.name){

      //                     role.books=role.books.filter(item=>{
      //                         return item.name!==bo.name;
      //                     })
      //                     if(role.books.length===0){

      //         document.querySelector(".content").innerHTML=`<h1>There is no books in my books page !!<br></h1>`;
      //                     }

      //                 }
      //                 for(let i=0;i<users.length;i++){
      //                     if(users[i].userName===JSON.parse(data.getItem("name"))){
      //                         users[i]=role;
      //                         data.setItem("users",JSON.stringify(users));
      //                         break;
      //                     }
      //                 }
      //             })
      //             boBook.style.display="none";
      //         }

      //     })
      //     // console.log(role.books);
      //     document.querySelector(".btn").addEventListener("click", function() {
      //         let search = document.querySelector(".srch").value.toLowerCase(); // Convert search query to lowercase for case-insensitive comparison
      //         // console.log(buttons);
      //          let check = true ;
      //         buttons.forEach(butt => {
      //             let bookName = butt.id.toLowerCase(); // Get the book name (ID) in lowercase
      //             let author = butt.querySelector(".author").textContent.toLowerCase(); // Get the author name in lowercase
      //             let category = butt.querySelector(".category").textContent.toLowerCase(); // Get the category in lowercase
      //             // Check if the book matches the search query
      //             // console.log(author);
      //             // console.log(category);

      //             if (bookName.includes(search) || author.includes(search) || category.includes(search)) {
      //                 butt.style.display = "block"; // Display the book
      //                 check = false;
      //             } else {
      //                 butt.style.display = "none"; // Hide the book
      //             }
      //         });
      //         if ( check){
      //             window.alert("Book not found");
      //         }
      //     });
      // }
    </script>
  </body>
</html>
